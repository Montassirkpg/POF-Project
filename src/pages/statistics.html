<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Statistiques par catégorie</title>
  <link rel="stylesheet" href="/src/style.css">
</head>
<body>
  <h1> Statistiques par catégorie</h1>
  <div id="resultats"></div>
  <button onclick="location.href='/index.html'">Retour à l'accueil</button>

  <script type="module">
    const resultats = document.getElementById("resultats");

    fetch("http://localhost:5000/api/categories/statistics")
      .then(res => {
        if (!res.ok) throw new Error("Échec de récupération des statistiques");
        return res.json();
      })
      .then(data => {
        if (!Array.isArray(data) || data.length === 0) {
          resultats.innerHTML = "<p>Aucune donnée disponible.</p>";
          return;
        }

        const list = document.createElement("ul");
        data.forEach(stat => {
          const item = document.createElement("li");
          item.textContent = `${stat.categorie} : ${stat.nombre} produit(s)`;
          list.appendChild(item);
        });

        resultats.appendChild(list);
      })
      .catch(err => {
        resultats.innerHTML = `<p style="color:red;">Erreur : ${err.message}</p>`;
        console.error("Erreur statistiques :", err);
      });
  </script>
</body>
</html>
